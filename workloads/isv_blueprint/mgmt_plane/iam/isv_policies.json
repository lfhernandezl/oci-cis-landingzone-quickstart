{
    "policies_configuration" : {
        "supplied_policies" : {
            "ROOT" : {
                "name" : "isv-root-policy",
                "description" : "Root compartment policy.",
                "compartment_id" : "TENANCY-ROOT",
                "statements" : [
                  "define tenancy usage-report as ocid1.tenancy.oc1..aaaaaaaaned4fkpkisbwjlr56u7cj63lf3wffbilvqknstgtvzub7vhqkggq", 
                  "endorse group isv-ops-governance-grp to read objects in tenancy usage-report",
                  "allow group isv-ops-network-grp, isv-ops-security-grp, isv-ops-governance-grp, isv-ops-customers-grp, isv-ops-snowflake-customers-grp to read objectstorage-namespaces in tenancy",
                  "allow group isv-ops-network-grp, isv-ops-security-grp, isv-ops-governance-grp, isv-ops-customers-grp, isv-ops-snowflake-customers-grp to inspect compartments in tenancy",
                  "allow group isv-ops-security-grp to manage cloudevents-rules in tenancy",
                  "allow group isv-ops-security-grp to manage alarms in tenancy",
                  "allow group isv-ops-security-grp to manage metrics in tenancy",
                  "allow group isv-ops-security-grp to manage cloud-guard-family in tenancy",
                  "allow group isv-ops-security-grp to read tenancies in tenancy",
                  "allow group isv-ops-security-grp to read audit-events in tenancy",
                  "allow group isv-ops-governance-grp to manage usage-report in tenancy",
                  "allow group isv-ops-governance-grp to manage usage-budgets in tenancy",
                  "allow group isv-auditors-grp to inspect all-resources in tenancy",
                  "allow group isv-auditors-grp to read instances in tenancy",
                  "allow group isv-auditors-grp to read load-balancers in tenancy",
                  "allow group isv-auditors-grp to read buckets in tenancy",
                  "allow group isv-auditors-grp to read nat-gateways in tenancy",
                  "allow group isv-auditors-grp to read public-ips in tenancy",
                  "allow group isv-auditors-grp to read file-family in tenancy",
                  "allow group isv-auditors-grp to read instance-configurations in tenancy",
                  "allow group isv-auditors-grp to read network-security-groups in tenancy",
                  "allow group isv-auditors-grp to read resource-availability in tenancy",
                  "allow group isv-auditors-grp to read audit-events in tenancy",
                  "allow group isv-auditors-grp to read users in tenancy",
                  "allow group isv-auditors-grp to read vss-family in tenancy",       
                  "allow group isv-auditors-grp to read data-safe-family in tenancy"
                ]
            },
            "NETWORK" : {
                "name" : "isv-mgmt-plane-network-policy",
                "description" : "Management plane network policy.",
                "compartment_id" : "TOP-CMP",
                "statements" : [
                  "allow group isv-ops-network-grp to manage virtual-network-family in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-network-grp to manage drgs in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-network-grp to manage load-balancers in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-network-grp to manage instance-family in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-network-grp to manage instance-agent-plugins in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-network-grp to manage volume-family in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-network-grp to manage file-family in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-network-grp to manage keys in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-network-grp to manage secret-family in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-network-grp to use key-delegate in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-network-grp to use vaults in compartment isv-mgmt-plane-cmp:isv-logging-cmp"
                ]            
            },
            "SECURITY" : {
                "name" : "isv-mgmt-plane-security-policy",
                "description" : "Management plane security policy.",
                "compartment_id" : "TOP-CMP",
                "statements" : [
                  "allow group isv-ops-security-grp to manage instance-family in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage volume-family in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage instance-agent-plugins in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage private-ips in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage vaults in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage keys in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to use key-delegate in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage subnets in compartment isv-mgmt-plane-cmp:isv-network-cmp where request.permission = 'SUBNET_UPDATE'",
                  "allow group isv-ops-security-grp to use network-security-groups in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-security-grp to use vnics in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-security-grp to manage ons-family in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage logging-family in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage stream-family in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage serviceconnectors in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage policies in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage vss-family in compartment isv-mgmt-plane-cmp",
                  "allow group isv-ops-security-grp to use buckets in compartment isv-mgmt-plane-cmp",
                  "allow group isv-ops-security-grp to inspect all-resources in compartment isv-mgmt-plane-cmp",
                  "allow group isv-ops-security-grp to use instances in compartment isv-mgmt-plane-cmp",
                  "allow group isv-ops-security-grp to read repos in compartment isv-mgmt-plane-cmp"
                ]            
              },
              "SHARED-SERVICES" : {
                "name" : "isv-mgmt-plane-shared-services-policy",
                "description" : "Management plane shared services policy.",
                "compartment_id" : "TOP-CMP",
                "statements" : [
                  "allow group isv-ops-security-grp to manage instance-family in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage volume-family in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage instance-agent-plugins in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage private-ips in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage vaults in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage keys in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to use key-delegate in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage subnets in compartment isv-mgmt-plane-cmp:isv-network-cmp where request.permission = 'SUBNET_UPDATE'",
                  "allow group isv-ops-security-grp to use network-security-groups in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-security-grp to use vnics in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-security-grp to manage ons-family in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage logging-family in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage stream-family in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage serviceconnectors in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage policies in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-security-grp to manage vss-family in compartment isv-mgmt-plane-cmp",
                  "allow group isv-ops-security-grp to use buckets in compartment isv-mgmt-plane-cmp",
                  "allow group isv-ops-security-grp to inspect all-resources in compartment isv-mgmt-plane-cmp",
                  "allow group isv-ops-security-grp to use instances in compartment isv-mgmt-plane-cmp",
                  "allow group isv-ops-security-grp to read repos in compartment isv-mgmt-plane-cmp"
                ]            
              },
              "CUSTOMERS" : {
                "name" : "isv-ops-customers-policy",
                "description" : "Customer operations policy.",
                "compartment_id" : "TOP-CMP",
                "statements" : [
                  "allow group isv-ops-customers-grp to manage compartments in compartment isv-customers-cmp", 
                  "allow group isv-ops-customers-grp to manage policies in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage virtual-network-family in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage instance-family in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage compute-management-family in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage instance-agent-family in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage instance-agent-command-family in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage auto-scaling-configurations in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage compute-capacity-reports in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage compute-capacity-reservations in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage compute-clusters in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage dedicated-vm-hosts in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage compute-global-image-capability-schema in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage compute-image-capability-schema in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to inspect work-requests in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage volume-family in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage file-family in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage buckets in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage private-ips in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage stream-family in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage functions-family in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage ons-family in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage api-gateway-family in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage cluster-family in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage autonomous-database-family in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage database-family in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage keys in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage secret-family in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to use key-delegate in compartment isv-customers-cmp",
                  "allow group isv-ops-customers-grp to manage drg-attachment in compartment isv-customers-cmp",
                  "allow group isv-ops-network-grp to read drg-attachment in compartment isv-customers-cmp"
                ]            
              },
              "SNOWFLAKE-CUSTOMERS" : {
                "name" : "isv-ops-snowflake-customers-policy",
                "description" : "Snowflake customer operations policy.",
                "compartment_id" : "TOP-CMP",
                "statements" : [
                  "allow group isv-ops-snowflake-customers-grp to manage compartments in compartment isv-snowflake-customers-cmp", 
                  "allow group isv-ops-snowflake-customers-grp to manage policies in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage virtual-network-family in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage instance-family in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage compute-management-family in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage instance-agent-family in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage instance-agent-command-family in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage auto-scaling-configurations in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage compute-capacity-reports in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage compute-capacity-reservations in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage compute-clusters in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage dedicated-vm-hosts in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage compute-global-image-capability-schema in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage compute-image-capability-schema in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to inspect work-requests in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage volume-family in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage file-family in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage buckets in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage private-ips in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage stream-family in compartment isv-snowflake-customers-cmp", 
                  "allow group isv-ops-snowflake-customers-grp to manage functions-family in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage ons-family in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage api-gateway-family in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage cluster-family in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage autonomous-database-family in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage database-family in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage keys in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage secret-family in compartment isv-snowflake-customers-cmp",
                  "allow group isv-ops-snowflake-customers-grp to use key-delegate in compartment isv-snowflake-customers-cmp"
                ]            
              },
              "CUSTOMER-OPS-ON-MGMT" : {
                "name" : "isv-customer-ops-on-mgmt-plane-policy",
                "description" : "Customer operations on management plane policy.",
                "compartment_id" : "TOP-CMP",
                "statements" : [
                  "allow group isv-ops-customers-grp to use vaults in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-customers-grp to use drg-object in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-customers-grp to manage drg-route-tables in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-customers-grp to manage drg-route-distribution in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-snowflake-customers-grp to use vaults in compartment isv-mgmt-plane-cmp:isv-logging-cmp",
                  "allow group isv-ops-snowflake-customers-grp to use drg-object in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage drg-route-tables in compartment isv-mgmt-plane-cmp:isv-network-cmp",
                  "allow group isv-ops-snowflake-customers-grp to manage drg-route-distribution in compartment isv-mgmt-plane-cmp:isv-network-cmp"
                ]  
            },
            "CONFIG" : {
                "name" : "isv-ops-config-policy",
                "description" : "Operations configuration policy.",
                "compartment_id" : "TOP-CMP",
                "statements" : [
                  "allow group isv-ops-network-grp, isv-ops-security-grp, isv-ops-governance-grp, isv-ops-customers-grp, isv-ops-snowflake-customers-grp to read buckets in compartment isv-terraform-shared-config-cmp",
                  "allow group isv-ops-network-grp, isv-ops-security-grp, isv-ops-governance-grp, isv-ops-customers-grp, isv-ops-snowflake-customers-grp to manage objects in compartment isv-terraform-shared-config-cmp where target.bucket.name = 'isv-terraform-shared-config-bucket'"
                ]
            },
            "OCI-SERVICES" : {
                "name" : "isv-oci-services-policy",
                "description" : "OCI services policy.",
                "compartment_id" : "TENANCY-ROOT",
                "statements" : [
                  "allow service vulnerability-scanning-service to manage instances in tenancy",
                  "allow service vulnerability-scanning-service to read compartments in tenancy",
                  "allow service vulnerability-scanning-service to read repos in tenancy",
                  "allow service vulnerability-scanning-service to read vnics in tenancy",
                  "allow service vulnerability-scanning-service to read vnic-attachments in tenancy",
                  "allow service cloudguard to read all-resources in tenancy",
                  "allow service cloudguard to use network-security-groups in tenancy",
                  "allow service blockstorage, oke, streaming, Fssoc1Prod, objectstorage-us-ashburn-1, objectstorage-us-phoenix-1, objectstorage-us-sanjose-1, objectstorage-ca-toronto-1 to use keys in tenancy"
                ]
              }
        }
    }
}